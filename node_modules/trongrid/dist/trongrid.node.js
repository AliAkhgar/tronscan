module.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e){t.exports=require("@babel/runtime/helpers/classCallCheck")},function(t,e){t.exports=require("@babel/runtime/helpers/createClass")},function(t,e){t.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(t,e){t.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(t,e){t.exports=require("@babel/runtime/helpers/inherits")},function(t,e){t.exports=require("@babel/runtime/regenerator")},function(t,e){t.exports=require("@babel/runtime/helpers/typeof")},function(t,e){t.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(t,e){t.exports=require("injectpromise")},function(t,e){t.exports=require("@babel/runtime/helpers/slicedToArray")},function(t,e,n){"use strict";n.r(e);var i,r,o,s,a,l,u,c,h,d=n(6),v=n.n(d),f=n(0),p=n.n(f),m=n(1),g=n.n(m),b=n(2),k=n.n(b),x=n(3),y=n.n(x),w=n(4),P=n.n(w),I=function(){function t(e){p()(this,t),this.tronGrid=e,this.apiNode=e.tronWeb.eventServer}return g()(t,[{key:"_httpClient",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"get";!e.experimental&&this.tronGrid.experimental&&(e.experimental=this.tronGrid.experimental),this.apiNode.request(t,e,i).then(function(t){e.only_data_and_fingerprint?n(null,t.data,t.meta.fingerprint):n(null,t)}).catch(function(t){return n(t)})}},{key:"get",value:function(t,e,n){return this._httpClient(t,e,n,"get")}},{key:"post",value:function(){}},{key:"put",value:function(){}},{key:"del",value:function(){}}]),t}(),E=function(){function t(e){p()(this,t),i=e.tronWeb,r=i.utils}return g()(t,[{key:"validatePageData",value:function(t){if(!t)throw new Error("Invalid data provided.");if("string"!=typeof t&&"object"!==v()(t))throw new Error("Invalid data format provided.");if("string"==typeof t&&-1===t.indexOf("fingerprint"))throw new Error("It's the last page or missed fingerprint in the links.");if(!("object"!==v()(t)||t.meta&&t.meta.fingerprint))throw new Error("It's the last page or missed fingerprint in the json.")}},{key:"validateAddress",value:function(t){if(!i.isAddress(t))throw new Error("Invalid address provided.")}},{key:"validateAssetIdentifier",value:function(t){if(!t||/[^a-zA-Z0-9_]+/.test(t))throw new Error("Invalid identifier provided.")}},{key:"validateBlockNumber",value:function(t){if("latest"!==t&&(!t||/[^0-9]/.test(t.toString())))throw new Error("Invalid block number provided.")}},{key:"validateTransactionId",value:function(t){if(!/^[a-z0-9]{64}/.test(t))throw new Error("Invalid transaction id provided.")}},{key:"validateOptions",value:function(t){if(t.limit&&(!r.isInteger(t.limit)||t.limit<0||t.limit>200))throw new Error("Limit should be a number between 0 and 200.");if(t.blockNumber&&!t.eventName)throw new Error("Usage of block number filtering requires an event name.");if(t.minBlockTimestamp&&!r.isInteger(t.minBlockTimestamp))throw new Error("Invalid minBlockTimestamp provided.");if(t.maxBlockTimestamp&&!r.isInteger(t.maxBlockTimestamp)&&"now"!==t.maxBlockTimestamp)throw new Error("Invalid maxBlockTimestamp provided.")}}]),t}(),T=n(8),j=n.n(T),A=function t(e){if(p()(this,t),!(e&&e instanceof D))throw new Error("Expected instance of TronGrid");this.tronGrid=e,this.tronWeb=e.tronWeb,this.injectPromise=j()(this),this.apiNode=this.tronWeb.eventServer,this.utils=this.tronWeb.utils,this.validator=new E(e),this.APIClient=new I(e)},_=function(t){function e(t){var n;return p()(this,e),n=k()(this,y()(e).call(this,t)),o=n.utils,n}return P()(e,t),g()(e,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.isFunction(e)&&(n=e,e={}),n?(this.validator.validateAddress(t),34!==t.length&&(t=this.tronWeb.address.fromHex(t)),this.APIClient.get("v1/accounts/".concat(t),e,n)):this.injectPromise(this.get,t,e)}},{key:"getTransactions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.isFunction(e)&&(n=e,e={}),n?(this.validator.validateAddress(t),34!==t.length&&(t=this.tronWeb.address.fromHex(t)),this.APIClient.get("v1/accounts/".concat(t,"/transactions"),e,n)):this.injectPromise(this.getTransactions,t,e)}},{key:"getTrc20Transactions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.isFunction(e)&&(n=e,e={}),n?(this.validator.validateAddress(t),34!==t.length&&(t=this.tronWeb.address.fromHex(t)),this.APIClient.get("v1/accounts/".concat(t,"/transactions/trc20"),e,n)):this.injectPromise(this.getTrc20Transactions,t,e)}}]),e}(A),C=function(t){function e(t){var n;return p()(this,e),n=k()(this,y()(e).call(this,t)),s=n.utils,n}return P()(e,t),g()(e,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(s.isFunction(e)&&(n=e,e={}),this.validator.validateAssetIdentifier(t),!n)return this.injectPromise(this.get,t,e);this.tronGrid.experimental&&(e.experimental=this.tronGrid.experimental),this.APIClient.get("v1/assets/".concat(t),e,n)}},{key:"getList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.isFunction(e)&&(n=e,e={}),this.validator.validateAssetIdentifier(t),this.validator.validateOptions(e),n?this.APIClient.get("v1/assets/".concat(t,"/list"),e,n):this.injectPromise(this.getList,t,e)}},{key:"getAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.isFunction(t)&&(e=t,t={}),this.validator.validateOptions(t),e?this.APIClient.get("v1/assets",t,e):this.injectPromise(this.getAll,t)}}]),e}(A),F=function(t){function e(t){var n;return p()(this,e),n=k()(this,y()(e).call(this,t)),a=n.utils,n}return P()(e,t),g()(e,[{key:"getEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"latest",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.isFunction(e)&&(n=e,e={}),n?(this.validator.validateBlockNumber(t),this.APIClient.get("v1/blocks/".concat(t,"/events"),e,n)):this.injectPromise(this.getEvents,t,e)}}]),e}(A),O=n(5),W=n.n(O),q=n(9),B=n.n(q),G=n(7),N=n.n(G),S=function(t){function e(t){var n;return p()(this,e),n=k()(this,y()(e).call(this,t)),l=n.utils,n}return P()(e,t),g()(e,[{key:"getEvents",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l.isFunction(e)&&(n=e,e={}),n?(this.validator.validateAddress(t),this.validator.validateOptions(e),t=this.tronWeb.address.fromHex(t),this.APIClient.get("v1/contracts/".concat(t,"/events"),e,n)):this.injectPromise(this.getEvents,t,e)}},{key:"getTrc20Tokens",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l.isFunction(e)&&(n=e,e={}),n?(this.validator.validateAddress(t),t=this.tronWeb.address.fromHex(t),this.APIClient.get("v1/contracts/".concat(t,"/tokens"),e,n)):this.injectPromise(this.getTrc20Tokens,t,e)}},{key:"watchEvent",value:function(){var t=N()(W.a.mark(function t(e,n){var i,r,o,s,a,u,c,h=this,d=arguments;return W.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=d.length>2&&void 0!==d[2]?d[2]:{},r=d.length>3&&void 0!==d[3]&&d[3],o=!1,s=!1,a=Date.now()-1e3,l.isFunction(i)&&(r=i,i={}),l.isFunction(r)){t.next=8;break}throw new Error("Invalid callback function provided");case 8:return u=function(){var t=N()(W.a.mark(function t(){var r,o,l,u,c,d;return W.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(i=Object.assign({eventName:n,minBlockTimestamp:a,orderBy:"timestamp,desc"},i)).only_data_and_fingerprint){t.next=8;break}return t.next=5,h.getEvents(e,i);case 5:r=t.sent,t.next=12;break;case 8:return t.next=10,h.getEvents(e,i);case 10:o=t.sent,r=o.data;case 12:return l=r.sort(function(t,e){return e.block_timestamp-t.block_timestamp}),u=B()(l,1),c=u[0],d=r.filter(function(t,e){return!r.slice(0,e).some(function(e){return JSON.stringify(e)==JSON.stringify(t)})&&(!s||t.block_timestamp>s)}),c&&(s=c.block_timestamp),t.abrupt("return",d);case 18:return t.prev=18,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 21:case"end":return t.stop()}},t,null,[[0,18]])}));return function(){return t.apply(this,arguments)}}(),c=function(){o&&clearInterval(o),o=setInterval(function(){u().then(function(t){return t.forEach(function(t){r(null,t)})}).catch(function(t){return r(t)})},3e3)},t.next=12,u();case 12:return c(),t.abrupt("return",{start:c(),stop:function(){o&&(clearInterval(o),o=!1)}});case 14:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}]),e}(A),H=function(t){function e(t){var n;return p()(this,e),n=k()(this,y()(e).call(this,t)),u=n.utils,n}return P()(e,t),g()(e,[{key:"getEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return u.isFunction(e)&&(n=e,e={}),n?(this.validator.validateTransactionId(t),this.APIClient.get("v1/transactions/".concat(t,"/events"),e,n)):this.injectPromise(this.getEvents,t,e)}}]),e}(A),M=function(t){function e(t){var n;return p()(this,e),n=k()(this,y()(e).call(this,t)),c=n.utils,h=n.tronGrid.account,n}return P()(e,t),g()(e,[{key:"setExperimental",value:function(t){this.tronGrid.setExperimental(t)}},{key:"getTransactions",value:function(){var t=N()(W.a.mark(function t(){var e,n,i,r,o,s,a=arguments;return W.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:this.tronWeb.defaultAddress.hex,n=a.length>1&&void 0!==a[1]?a[1]:"all",i=a.length>2&&void 0!==a[2]?a[2]:20,r=a.length>3&&void 0!==a[3]?a[3]:0,o=a.length>4&&void 0!==a[4]&&a[4],c.isFunction(r)&&(o=r),c.isFunction(i)&&(o=i,i=20),c.isFunction(n)&&(o=n,n="all"),c.isFunction(e)&&(o=e,e=this.tronWeb.defaultAddress.hex),s={limit:i,only_data_and_fingerprint:!0},"to"===n?s.only_to=!0:"from"===n&&(s.only_from=!0),t.abrupt("return",h.getTransactions(e,s,o));case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),e}(A);n.d(e,"default",function(){return D});var D=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(p()(this,t),!e)throw new Error("Expected instance of TronWeb");this.tronWeb=e,this.utils=e.utils,this.account=new _(this),this.asset=new C(this),this.block=new F(this),this.contract=new S(this),this.transaction=new H(this),this.apiClient=new I(this),this.validator=new E(this),this.injectPromise=j()(this),this.experimental=void 0}return g()(t,[{key:"setExperimental",value:function(t){this.experimental=t}},{key:"pluginInterface",value:function(t){t.experimental&&t.experimental;var e=new M(this);return e.setExperimental(t.experimental),{requires:"^2.2.4",components:{trx:{getTransactionsRelated:e.getTransactions}}}}},{key:"nextPage",value:function(t,e){return e?(this.validator.validatePageData(t),"string"==typeof t?this.apiClient.get(t,{},e):"object"===v()(t)?this.apiClient.get(t.meta.links.next,{},e):void 0):this.injectPromise(this.nextPage,t)}}]),t}()}]).default;
//# sourceMappingURL=trongrid.node.js.map